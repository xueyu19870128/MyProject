!function(e,t){"use strict";function i(e,t){e.className+=" "+t}function a(t,i){var a=e.URL||e.webkitURL;if(a)return i(a.createObjectURL(t));if(e.FileReader){var r=new FileReader;r.onload=function(e){i(e.target.result)},r.readAsDataURL(t)}else t.readAsDataURL&&i(t.readAsDataURL())}function r(e,i,r){var n=i.input,o=i.file||(n.files?n.files[0]:t);if(o)a(o,function(t){t&&(e.innerHTML='<img src="'+t+'" />'),r&&r(t)});else if(n){var s=n.value;if(s&&!/^\w:\\fakepath/.test(s)||(n.select(),parent.document.body.focus(),document.selection&&(s=document.selection.createRange().text)),s){e.innerHTML='<img src="'+s+'" />';try{u>6&&(e.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod='scale',src='"+s+"')")}catch(e){}}r&&r(s)}}function n(e,t,i,a){var r=new Image;r.src=e,r.onload=function(){var e=r.width,n=r.height,o=i.maxWidth,s=i.maxHeight,l=o&&e>o,c=s&&n>s;if(!(l||c))return a&&a(!1);l&&(e=o,n=Math.floor(r.height*e/r.width)),c&&(n=s,e=Math.floor(r.width*n/r.height));var u=document.createElement("canvas"),d=u.getContext("2d");u.width=e,u.height=n,d.drawImage(r,0,0,e,n),a&&a(u.toDataURL(t),t)}}var o=Q.getFirst,s=Q.getNext,l=Q.createEle,c=Q.setOpacity,u=Q.ie,d=Q.Uploader,f=e.Blob||e.WebkitBlob||e.MozBlob,g=e.WebKitBlobBuilder||e.MozBlobBuilder,p=function(){if(!e.FileReader||!e.atob||!f&&!g)return!1;var t=document.createElement("canvas");return!!t.getContext&&!!t.getContext("2d")}(),v=".jpg,.png,.gif,.bmp,.webp,.tif,.tiff";d.support.imageScale=p,d.previewImage=r,d.scaleImage=n,d.UI.Image={init:function(){var e=this.ops,t=e.view;e.allows||(e.allows=v),t&&i(t,"ui-image "+(this.html5?"html5":"html4"))},supportScale:function(e){if(!p)return!1;".jpeg"==e&&(e=".jpg");var t=(this.ops.scale||{}).types||".jpg";return!!(-1!=v.indexOf(e))&&("*"==t||-1!=t.indexOf(e))},previewImage:function(e,t,i){var a=this,o=t.scale||i.scale,s=o&&a.supportScale(t.ext);return s&&(t.skip=!0),r(e,t,function(e){a.fire("preview",{task:t,src:e}),e&&s&&n(e,function(e){var t=e.slice(1);return"image/"+("jpg"==t?"jpeg":t)}(t.ext),o,function(e,i){if(e){var r=function(e,t){for(var i=e.split(","),a=atob(i[1]),r=[],n=0,o=a.length;o>n;n++)r[n]=a.charCodeAt(n);if(f)return new f([new Uint8Array(r)],{type:t});var s=new g;return s.append(r),s.getBlob(t)}(e,i);t.blob=r,a.fire("scale",{task:t,base64:e,type:i,blob:r})}t.skip=!1,a.list.push(t),a.auto&&a.start()})}),a},draw:function(e){var t=this.ops,i=t.view;if(i){var a=e.name,r='<div class="u-img"></div><div class="u-progress-bar"><div class="u-progress"></div></div><div class="u-detail"></div><div class="u-name" title="'+a+'">'+a+"</div>",n=e.id,u=l("div","u-item",r);u.taskId=n;var d=o(u),f=s(d),g=o(f),p=s(f);c(f,.3),c(g,.5),e.box=u,e.boxProgress=g,e.boxDetail=p,i.appendChild(u),this.previewImage(d,e,t).update(e)}},update:function(e){if(e&&e.box){var i=e.total||e.size,a=e.loaded,r=e.state,n=e.boxProgress,o=e.boxDetail,s=d.getStatusText(r);if(this.html5&&a!=t&&a>=0){var l;if(r==d.PROCESSING)"100.0"==(l=Math.min(100*a/i,100).toFixed(1))&&(l="99.9");else r==d.COMPLETE&&(l="100");l&&(s+=" "+(l+="%"),n.style.width=l)}!function(e,t){e&&(e.innerHTML=t||"")}(o,s)}},over:function(e){e&&e.box&&i(e.box,"u-over")}},d.extend(d.UI.Image)}(window);